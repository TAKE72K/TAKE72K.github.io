<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>安裝docker | 竹林七閒</title>
<meta name="keywords" content="centos" />
<meta name="description" content="Docker feat. CentOS 7 安裝 sudo yum-config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.reposudo yum repolist -v #Now you can observe the packages available from the docker-ce reposudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.4.3-3.1.el7.x86_64.rpmsudo yum install docker-ce -ysudo systemctl --now enable docker測試安裝
sudo docker run --rm hello-world應該輸出:
Hello from Docker!This message shows that your installation appears to be working correctly.To generate this message, Docker took the following steps:1. The Docker client contacted the Docker daemon.">
<meta name="author" content="">
<link rel="canonical" href="https://take72k.github.io/posts/note/dockerinstall/" />
<link crossorigin="anonymous" href="https://take72k.github.io/assets/css/stylesheet.min.b9ff4cc257e914dab489bd18086151800e18f91456a5174bf28489210227a659.css" integrity="sha256-uf9MwlfpFNq0ib0YCGFRgA4Y&#43;RRWpRdL8oSJIQInplk=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="https://take72k.github.io/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://take72k.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://take72k.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://take72k.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://take72k.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://take72k.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.93.0-DEV" />
<meta property="og:title" content="安裝docker" />
<meta property="og:description" content="Docker feat. CentOS 7 安裝 sudo yum-config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.reposudo yum repolist -v #Now you can observe the packages available from the docker-ce reposudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.4.3-3.1.el7.x86_64.rpmsudo yum install docker-ce -ysudo systemctl --now enable docker測試安裝
sudo docker run --rm hello-world應該輸出:
Hello from Docker!This message shows that your installation appears to be working correctly.To generate this message, Docker took the following steps:1. The Docker client contacted the Docker daemon." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://take72k.github.io/posts/note/dockerinstall/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-13T21:18:00&#43;00:00" />
<meta property="article:modified_time" content="2022-12-13T21:18:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="安裝docker"/>
<meta name="twitter:description" content="Docker feat. CentOS 7 安裝 sudo yum-config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.reposudo yum repolist -v #Now you can observe the packages available from the docker-ce reposudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.4.3-3.1.el7.x86_64.rpmsudo yum install docker-ce -ysudo systemctl --now enable docker測試安裝
sudo docker run --rm hello-world應該輸出:
Hello from Docker!This message shows that your installation appears to be working correctly.To generate this message, Docker took the following steps:1. The Docker client contacted the Docker daemon."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://take72k.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "安裝docker",
      "item": "https://take72k.github.io/posts/note/dockerinstall/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "安裝docker",
  "name": "安裝docker",
  "description": "Docker feat. CentOS 7 安裝 sudo yum-config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo\rsudo yum repolist -v #Now you can observe the packages available from the docker-ce repo\rsudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.4.3-3.1.el7.x86_64.rpm\rsudo yum install docker-ce -y\rsudo systemctl --now enable docker\r測試安裝\nsudo docker run --rm hello-world\r應該輸出:\nHello from Docker!\rThis message shows that your installation appears to be working correctly.\rTo generate this message, Docker took the following steps:\r1. The Docker client contacted the Docker daemon.",
  "keywords": [
    "centos"
  ],
  "articleBody": "Docker feat. CentOS 7 安裝 sudo yum-config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo\rsudo yum repolist -v #Now you can observe the packages available from the docker-ce repo\rsudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.4.3-3.1.el7.x86_64.rpm\rsudo yum install docker-ce -y\rsudo systemctl --now enable docker\r測試安裝\nsudo docker run --rm hello-world\r應該輸出:\nHello from Docker!\rThis message shows that your installation appears to be working correctly.\rTo generate this message, Docker took the following steps:\r1. The Docker client contacted the Docker daemon.\r2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub.\r(amd64)\r3. The Docker daemon created a new container from that image which runs the\rexecutable that produces the output you are currently reading.\r4. The Docker daemon streamed that output to the Docker client, which sent it\rto your terminal.\rTo try something more ambitious, you can run an Ubuntu container with:\r$ docker run -it ubuntu bash\rShare images, automate workflows, and more with a free Docker ID:\rhttps://hub.docker.com/\rFor more examples and ideas, visit:\rhttps://docs.docker.com/get-started/\r免除sudo 預設每次要用docker都要sudo，可以將用戶加入群組。 但注意安全性問題\nsudo groupadd docker\rsudo usermod -aG docker $USER\rnewgrp docker\r重新登入帳號以更新群組， 測試\ndocker run hello-world\r在CentOS 7上設定docker + GPU 安裝NVIDIA Container Toolkit 加入儲存庫位址\ndistribution=$(. /etc/os-release;echo $ID$VERSION_ID) \\\r\u0026\u0026 curl -s -L https://nvidia.github.io/libnvidia-container/$distribution/libnvidia-container.repo | sudo tee /etc/yum.repos.d/nvidia-container-toolkit.repo\r清除緩存\nsudo yum clean expire-cache\r安裝toolkit\nsudo yum install -y nvidia-docker2\r重啟並測試docker\nsudo docker run --rm --gpus all nvidia/cuda:11.6.2-base-ubuntu20.04 nvidia-smi\r如果印出\n+-----------------------------------------------------------------------------+\r| NVIDIA-SMI 515.65.01 Driver Version: 515.65.01 CUDA Version: 11.7 |\r|-------------------------------+----------------------+----------------------+\r| GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC |\r| Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. |\r| | | MIG M. |\r|===============================+======================+======================|\r| 0 Tesla T4 Off | 00000000:37:00.0 Off | 0 |\r| N/A 65C P8 17W / 70W | 2MiB / 15360MiB | 0% Default |\r| | | N/A |\r+-------------------------------+----------------------+----------------------+\r+-----------------------------------------------------------------------------+\r| Processes: |\r| GPU GI CI PID Type Process name GPU Memory |\r| ID ID Usage |\r|=============================================================================|\r| No running processes found |\r+-----------------------------------------------------------------------------+\r就成功了。\n",
  "wordCount" : "328",
  "inLanguage": "en",
  "datePublished": "2022-12-13T21:18:00Z",
  "dateModified": "2022-12-13T21:18:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://take72k.github.io/posts/note/dockerinstall/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "竹林七閒",
    "logo": {
      "@type": "ImageObject",
      "url": "https://take72k.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://take72k.github.io" accesskey="h" title="竹林七閒 (Alt + H)">竹林七閒</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      安裝docker
    </h1>
    <div class="post-meta">December 13, 2022
</div>
  </header> 
  <div class="post-content"><h1 id="docker-feat-centos-7">Docker feat. CentOS 7<a hidden class="anchor" aria-hidden="true" href="#docker-feat-centos-7">#</a></h1>
<h2 id="安裝">安裝<a hidden class="anchor" aria-hidden="true" href="#安裝">#</a></h2>
<pre tabindex="0"><code class="language-bash=" data-lang="bash=">sudo yum-config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo
sudo yum repolist -v #Now you can observe the packages available from the docker-ce repo
sudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.4.3-3.1.el7.x86_64.rpm
sudo yum install docker-ce -y
sudo systemctl --now enable docker
</code></pre><p>測試安裝</p>
<pre tabindex="0"><code class="language-bash=" data-lang="bash=">sudo docker run --rm hello-world
</code></pre><p>應該輸出:</p>
<pre tabindex="0"><code>Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
</code></pre><h2 id="免除sudo">免除sudo<a hidden class="anchor" aria-hidden="true" href="#免除sudo">#</a></h2>
<p>預設每次要用docker都要sudo，可以將用戶加入群組。
但注意<strong>安全性問題</strong></p>
<pre tabindex="0"><code class="language-bash=" data-lang="bash=">sudo groupadd docker
sudo usermod -aG docker $USER
newgrp docker
</code></pre><p>重新登入帳號以更新群組，
測試</p>
<pre tabindex="0"><code class="language-bash=" data-lang="bash=">docker run hello-world
</code></pre><h2 id="在centos-7上設定docker--gpu">在CentOS 7上設定docker + GPU<a hidden class="anchor" aria-hidden="true" href="#在centos-7上設定docker--gpu">#</a></h2>
<p>安裝NVIDIA Container Toolkit
加入儲存庫位址</p>
<pre tabindex="0"><code class="language-bash=" data-lang="bash="> distribution=$(. /etc/os-release;echo $ID$VERSION_ID) \
   &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/$distribution/libnvidia-container.repo | sudo tee /etc/yum.repos.d/nvidia-container-toolkit.repo
</code></pre><p>清除緩存</p>
<pre tabindex="0"><code class="language-bash=" data-lang="bash=">sudo yum clean expire-cache
</code></pre><p>安裝toolkit</p>
<pre tabindex="0"><code class="language-bash=" data-lang="bash=">sudo yum install -y nvidia-docker2
</code></pre><p>重啟並測試docker</p>
<pre tabindex="0"><code class="language-bash=" data-lang="bash=">sudo docker run --rm --gpus all nvidia/cuda:11.6.2-base-ubuntu20.04 nvidia-smi
</code></pre><p>如果印出</p>
<pre tabindex="0"><code>+-----------------------------------------------------------------------------+
| NVIDIA-SMI 515.65.01    Driver Version: 515.65.01    CUDA Version: 11.7     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:37:00.0 Off |                    0 |
| N/A   65C    P8    17W /  70W |      2MiB / 15360MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
</code></pre><p>就成功了。</p>


  </div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://take72k.github.io/tags/centos/">centos</a></li>
    </ul>
  </footer>
</article>
    </main>
    <footer class="footer">
    <span>&copy; 2023 <a href="https://take72k.github.io">竹林七閒</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
